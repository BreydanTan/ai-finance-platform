# AI è´¢åŠ¡å¹³å°ï¼ˆWelthï¼‰- æŠ€æœ¯è§„æ ¼æ–‡æ¡£

**ç‰ˆæœ¬**: 1.0
**ç”Ÿæˆæ—¥æœŸ**: 2025-11-16
**ç›®æ ‡è¯»è€…**: å¼€å‘è€…ã€æŠ€æœ¯ç»ç†ã€äºŒæ¬¡å¼€å‘äººå‘˜

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#2-æŠ€æœ¯æ¶æ„)
3. [æ•°æ®åº“è®¾è®¡](#3-æ•°æ®åº“è®¾è®¡)
4. [æ ¸å¿ƒä¸šåŠ¡æµç¨‹](#4-æ ¸å¿ƒä¸šåŠ¡æµç¨‹)
5. [å‰åç«¯äº¤äº’](#5-å‰åç«¯äº¤äº’)
6. [API æ¥å£æ–‡æ¡£](#6-api-æ¥å£æ–‡æ¡£)
7. [ç¯å¢ƒé…ç½®æŒ‡å—](#7-ç¯å¢ƒé…ç½®æŒ‡å—)
8. [äºŒæ¬¡å¼€å‘æŒ‡å—](#8-äºŒæ¬¡å¼€å‘æŒ‡å—)
9. [éƒ¨ç½²æŒ‡å—](#9-éƒ¨ç½²æŒ‡å—)
10. [é™„å½•](#10-é™„å½•)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹

**Welth** æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ä¸ªäººè´¢åŠ¡ç®¡ç†å¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·è¿½è¸ªæ”¶æ”¯ã€ç®¡ç†é¢„ç®—ã€åˆ†æè´¢åŠ¡è¶‹åŠ¿ã€‚

**æ ¸å¿ƒç†å¿µ**:
- ğŸ“Š **æ•°æ®å¯è§†åŒ–** - ç›´è§‚çš„å›¾è¡¨å±•ç¤ºè´¢åŠ¡çŠ¶å†µ
- ğŸ¤– **AI èµ‹èƒ½** - æ™ºèƒ½æ”¶æ®æ‰«æå’Œè´¢åŠ¡æ´å¯Ÿ
- ğŸ“± **ç§»åŠ¨ä¼˜å…ˆ** - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ‰€æœ‰è®¾å¤‡
- ğŸ”’ **å®‰å…¨ç¬¬ä¸€** - å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œä¿æŠ¤ç”¨æˆ·æ•°æ®

### 1.2 ä¸»è¦åŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | è¯´æ˜ | æŠ€æœ¯äº®ç‚¹ |
|---------|------|---------|
| **è´¦æˆ·ç®¡ç†** | å¤šè´¦æˆ·æ”¯æŒï¼ˆæ´»æœŸ/å‚¨è“„ï¼‰ | Prisma ORM + PostgreSQL |
| **äº¤æ˜“è®°å½•** | æ”¶å…¥/æ”¯å‡ºè·Ÿè¸ªï¼Œæ”¯æŒå¾ªç¯äº¤æ˜“ | Server Actions + å®æ—¶æ›´æ–° |
| **æ”¶æ®æ‰«æ** | AI é©±åŠ¨çš„ OCR æ•°æ®æå– | Google Gemini AI |
| **é¢„ç®—ç®¡ç†** | æœˆåº¦é¢„ç®—è®¾ç½®å’Œè·Ÿè¸ª | å®æ—¶é¢„ç®—è¿›åº¦ç›‘æ§ |
| **æ•°æ®å¯è§†åŒ–** | å›¾è¡¨å’Œè¶‹åŠ¿åˆ†æ | Recharts åº“ |
| **é‚®ä»¶é€šçŸ¥** | é¢„ç®—è­¦æŠ¥å’Œæœˆåº¦æŠ¥å‘Š | Resend + Inngest |
| **åå°ä½œä¸š** | è‡ªåŠ¨åŒ–ä»»åŠ¡å¤„ç† | Inngest è®¡åˆ’ä½œä¸š |

### 1.3 æŠ€æœ¯äº®ç‚¹

âœ… **Next.js 15** - æœ€æ–°çš„ App Router æ¶æ„
âœ… **React 19 RC** - æœåŠ¡å™¨ç»„ä»¶ä¼˜å…ˆ
âœ… **Prisma ORM** - ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®
âœ… **Clerk** - ä¼ä¸šçº§è®¤è¯è§£å†³æ–¹æ¡ˆ
âœ… **ArcJet** - æ™ºèƒ½å®‰å…¨é˜²æŠ¤å’Œé€Ÿç‡é™åˆ¶
âœ… **Tailwind CSS** - å®ç”¨ä¼˜å…ˆçš„æ ·å¼ç³»ç»Ÿ
âœ… **TypeScript** - å…¨æ ˆç±»å‹å®‰å…¨ï¼ˆé€šè¿‡ JSDocï¼‰

### 1.4 é€‚ç”¨åœºæ™¯

- ğŸ‘¤ **ä¸ªäººè´¢åŠ¡ç®¡ç†** - è¿½è¸ªæ—¥å¸¸å¼€æ”¯å’Œæ”¶å…¥
- ğŸ’¼ **è‡ªç”±èŒä¸šè€…** - ç®¡ç†å¤šä¸ªæ”¶å…¥æ¥æº
- ğŸ  **å®¶åº­é¢„ç®—** - å…±åŒç®¡ç†å®¶åº­è´¢åŠ¡
- ğŸ“ˆ **è´¢åŠ¡åˆ†æ** - äº†è§£æ”¯å‡ºæ¨¡å¼å’Œè¶‹åŠ¿

---

## 2. æŠ€æœ¯æ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·æµè§ˆå™¨                              â”‚
â”‚                    (Chrome, Safari, Firefox)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTPS
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vercel Edge Network                       â”‚
â”‚                  (CDN + Edge Functions)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Next.js 15 Application                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   å‰ç«¯å±‚      â”‚  â”‚   API å±‚     â”‚  â”‚   åå°ä½œä¸š    â”‚     â”‚
â”‚  â”‚  React 19    â”‚  â”‚ Server       â”‚  â”‚  Inngest     â”‚     â”‚
â”‚  â”‚  Components  â”‚  â”‚ Actions      â”‚  â”‚  Functions   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â”‚                  â–¼                  â”‚
          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
          â”‚         â”‚   Middleware   â”‚         â”‚
          â”‚         â”‚  - ArcJet      â”‚         â”‚
          â”‚         â”‚  - Clerk Auth  â”‚         â”‚
          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
          â”‚                  â”‚                  â”‚
          â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Clerk Auth    â”‚ â”‚   PostgreSQL   â”‚ â”‚   Inngest    â”‚
â”‚   (Sessions)    â”‚ â”‚   (Supabase)   â”‚ â”‚   (Cron)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â”‚                  â–¼                  â–¼
          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚         â”‚   Prisma ORM   â”‚ â”‚  Email Jobs  â”‚
          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¤–éƒ¨æœåŠ¡å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Clerk   â”‚  â”‚  Resend  â”‚  â”‚  Gemini  â”‚  â”‚  ArcJet  â”‚   â”‚
â”‚  â”‚  (Auth)  â”‚  â”‚  (Email) â”‚  â”‚   (AI)   â”‚  â”‚ (Securityâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æŠ€æœ¯æ ˆè¯´æ˜

#### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ä½œç”¨ |
|-----|------|------|
| **Next.js** | 15.0.3 | React æ¡†æ¶ï¼ŒApp Router æ¶æ„ |
| **React** | 19 RC | UI åº“ï¼ŒæœåŠ¡å™¨ç»„ä»¶ + å®¢æˆ·ç«¯ç»„ä»¶ |
| **Tailwind CSS** | 3.4.1 | å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶ |
| **Radix UI** | å¤šä¸ªåŒ… | æ— éšœç¢ UI ç»„ä»¶åº“ |
| **Recharts** | 2.14.1 | æ•°æ®å¯è§†åŒ–å›¾è¡¨åº“ |
| **React Hook Form** | 7.53.2 | è¡¨å•çŠ¶æ€ç®¡ç† |
| **Zod** | 3.23.8 | Schema éªŒè¯åº“ |
| **date-fns** | 4.1.0 | æ—¥æœŸå¤„ç†å·¥å…· |

#### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ä½œç”¨ |
|-----|------|------|
| **Prisma** | 6.0.1 | ç±»å‹å®‰å…¨çš„ ORM |
| **PostgreSQL** | 15+ | å…³ç³»å‹æ•°æ®åº“ |
| **Clerk** | 6.6.0 | è®¤è¯å’Œç”¨æˆ·ç®¡ç† |
| **ArcJet** | 1.0.0-alpha.34 | å®‰å…¨é˜²æŠ¤å’Œé€Ÿç‡é™åˆ¶ |
| **Inngest** | 3.27.4 | åå°ä½œä¸šå’Œè®¡åˆ’ä»»åŠ¡ |

#### AI å’Œé€šä¿¡æœåŠ¡

| æœåŠ¡ | ç”¨é€” |
|-----|------|
| **Google Gemini** | æ”¶æ® OCRã€è´¢åŠ¡æ´å¯Ÿ |
| **Resend** | äº¤æ˜“é‚®ä»¶å‘é€ |

### 2.3 å‰åç«¯äº¤äº’æ¨¡å¼

#### æ•°æ®æµå‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç”¨æˆ·æ“ä½œ                                 â”‚
â”‚             (ç‚¹å‡»æŒ‰é’®ã€æäº¤è¡¨å•ã€ä¸Šä¼ æ–‡ä»¶)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  å®¢æˆ·ç«¯ç»„ä»¶      â”‚
            â”‚  - useState     â”‚
            â”‚  - useForm      â”‚
            â”‚  - useFetch     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ è°ƒç”¨
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Server Action  â”‚
            â”‚  "use server"   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¤è¯æ£€æŸ¥      â”‚         â”‚  é€Ÿç‡é™åˆ¶      â”‚
â”‚  await auth() â”‚         â”‚  ArcJet       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ä¸šåŠ¡é€»è¾‘        â”‚
            â”‚  - éªŒè¯          â”‚
            â”‚  - è½¬æ¢          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Prisma Query   â”‚
            â”‚  - findUnique   â”‚
            â”‚  - create       â”‚
            â”‚  - update       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  PostgreSQL     â”‚
            â”‚  æ•°æ®åº“          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  revalidatePath â”‚
            â”‚  æ¸…é™¤ç¼“å­˜        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  è¿”å›ç»“æœ        â”‚
            â”‚  { success,     â”‚
            â”‚    data }       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  å®¢æˆ·ç«¯æ›´æ–°      â”‚
            â”‚  - Toast æç¤º   â”‚
            â”‚  - é¡µé¢åˆ·æ–°     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. æ•°æ®åº“è®¾è®¡

### 3.1 ER å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      User       â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)         â”‚
â”‚ clerkUserId *   â”‚â”€â”€â”
â”‚ email           â”‚  â”‚
â”‚ name            â”‚  â”‚
â”‚ imageUrl        â”‚  â”‚
â”‚ createdAt       â”‚  â”‚
â”‚ updatedAt       â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â”‚ 1:N
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                        â”‚              â”‚
        â–¼                        â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Account      â”‚    â”‚   Transaction   â”‚    â”‚     Budget      â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)         â”‚    â”‚ id (PK)         â”‚    â”‚ id (PK)         â”‚
â”‚ name            â”‚â—„â”€â” â”‚ type            â”‚    â”‚ amount          â”‚
â”‚ type            â”‚  â”‚ â”‚ amount          â”‚    â”‚ userId (FK)     â”‚
â”‚ balance         â”‚  â”‚ â”‚ description     â”‚    â”‚ accountId (FK)  â”‚
â”‚ isDefault       â”‚  â”‚ â”‚ date            â”‚    â”‚ month           â”‚
â”‚ userId (FK)     â”‚  â”‚ â”‚ category        â”‚    â”‚ year            â”‚
â”‚ createdAt       â”‚  â”‚ â”‚ receipt         â”‚    â”‚ lastAlertSent   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ isRecurring     â”‚    â”‚ createdAt       â”‚
         â”‚           â”‚ â”‚ recurringInterval   â”‚ updatedAt       â”‚
         â”‚ 1:N       â”‚ â”‚ nextRecurringDate   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”‚ accountId (FK)  â”‚
                     â”‚ â”‚ userId (FK)     â”‚
                     â”‚ â”‚ status          â”‚
                     â”‚ â”‚ createdAt       â”‚
                     â”‚ â”‚ updatedAt       â”‚
                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â””â”€â”€â”€ 1:N
```

### 3.2 æ•°æ®è¡¨è¯¦è§£

#### User è¡¨ï¼ˆç”¨æˆ·ï¼‰

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|-----|------|------|------|
| id | String | PK, UUID | ä¸»é”® |
| clerkUserId | String | UNIQUE, NOT NULL | Clerk ç”¨æˆ· ID |
| email | String | UNIQUE, NOT NULL | é‚®ç®±åœ°å€ |
| name | String | - | ç”¨æˆ·å§“å |
| imageUrl | String | - | å¤´åƒ URL |
| createdAt | DateTime | DEFAULT NOW | åˆ›å»ºæ—¶é—´ |
| updatedAt | DateTime | AUTO UPDATE | æ›´æ–°æ—¶é—´ |

**å…³ç³»**:
- `accounts` - ä¸€å¯¹å¤š â†’ Account
- `transactions` - ä¸€å¯¹å¤š â†’ Transaction
- `budgets` - ä¸€å¯¹å¤š â†’ Budget

#### Account è¡¨ï¼ˆè´¦æˆ·ï¼‰

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|-----|------|------|------|
| id | String | PK, UUID | ä¸»é”® |
| name | String | NOT NULL | è´¦æˆ·åç§° |
| type | AccountType | NOT NULL | CURRENT / SAVINGS |
| balance | Decimal | DEFAULT 0 | å½“å‰ä½™é¢ |
| isDefault | Boolean | DEFAULT FALSE | æ˜¯å¦é»˜è®¤è´¦æˆ· |
| userId | String | FK, NOT NULL | å…³è”ç”¨æˆ· |
| createdAt | DateTime | DEFAULT NOW | åˆ›å»ºæ—¶é—´ |
| updatedAt | DateTime | AUTO UPDATE | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•**:
- `userId` - åŠ é€Ÿç”¨æˆ·è´¦æˆ·æŸ¥è¯¢
- `userId + isDefault` - æŸ¥æ‰¾é»˜è®¤è´¦æˆ·

#### Transaction è¡¨ï¼ˆäº¤æ˜“ï¼‰

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|-----|------|------|------|
| id | String | PK, UUID | ä¸»é”® |
| type | TransactionType | NOT NULL | INCOME / EXPENSE |
| amount | Decimal | NOT NULL | äº¤æ˜“é‡‘é¢ |
| description | String | - | äº¤æ˜“æè¿° |
| date | DateTime | NOT NULL | äº¤æ˜“æ—¥æœŸ |
| category | String | NOT NULL | åˆ†ç±»ï¼ˆä»é¢„è®¾åˆ—è¡¨ï¼‰ |
| receipt | String | - | æ”¶æ® URL |
| isRecurring | Boolean | DEFAULT FALSE | æ˜¯å¦å¾ªç¯äº¤æ˜“ |
| recurringInterval | RecurringInterval | - | å¾ªç¯é—´éš” |
| nextRecurringDate | DateTime | - | ä¸‹æ¬¡æ‰§è¡Œæ—¥æœŸ |
| accountId | String | FK, NOT NULL | å…³è”è´¦æˆ· |
| userId | String | FK, NOT NULL | å…³è”ç”¨æˆ· |
| status | TransactionStatus | DEFAULT COMPLETED | äº¤æ˜“çŠ¶æ€ |
| createdAt | DateTime | DEFAULT NOW | åˆ›å»ºæ—¶é—´ |
| updatedAt | DateTime | AUTO UPDATE | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•**:
- `userId` - ç”¨æˆ·äº¤æ˜“æŸ¥è¯¢
- `accountId` - è´¦æˆ·äº¤æ˜“æŸ¥è¯¢
- `date` - æ—¥æœŸèŒƒå›´æŸ¥è¯¢
- `isRecurring + nextRecurringDate` - å¾ªç¯äº¤æ˜“å¤„ç†

#### Budget è¡¨ï¼ˆé¢„ç®—ï¼‰

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|-----|------|------|------|
| id | String | PK, UUID | ä¸»é”® |
| amount | Decimal | NOT NULL | é¢„ç®—é‡‘é¢ |
| userId | String | FK, NOT NULL | å…³è”ç”¨æˆ· |
| accountId | String | FK, NOT NULL | å…³è”è´¦æˆ· |
| month | Int | NOT NULL | æœˆä»½ (1-12) |
| year | Int | NOT NULL | å¹´ä»½ |
| lastAlertSent | DateTime | - | æœ€åè­¦æŠ¥æ—¶é—´ |
| createdAt | DateTime | DEFAULT NOW | åˆ›å»ºæ—¶é—´ |
| updatedAt | DateTime | AUTO UPDATE | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•**:
- `userId + accountId + year + month` - å”¯ä¸€é¢„ç®—

### 3.3 æ•°æ®æµå›¾

#### åˆ›å»ºäº¤æ˜“çš„æ•°æ®æµ

```
1. ç”¨æˆ·æäº¤è¡¨å•
   â†“
2. createTransaction(data)
   â†“
3. Prisma äº‹åŠ¡å¼€å§‹
   â”œâ”€ åˆ›å»º Transaction è®°å½•
   â”‚  â””â”€ INSERT INTO "Transaction" (...)
   â”œâ”€ è®¡ç®—æ–°ä½™é¢
   â”‚  â””â”€ newBalance = oldBalance Â± amount
   â””â”€ æ›´æ–° Account ä½™é¢
      â””â”€ UPDATE "Account" SET balance = newBalance
   â†“
4. äº‹åŠ¡æäº¤
   â†“
5. revalidatePath("/dashboard")
   â†“
6. è¿”å›æ–°äº¤æ˜“æ•°æ®
```

---

## 4. æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 4.1 ç”¨æˆ·æ³¨å†Œ/ç™»å½•æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·è®¿é—®åº”ç”¨é¦–é¡µ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Middleware æ£€æŸ¥  â”‚
            â”‚ æ˜¯å¦å·²ç™»å½•ï¼Ÿ     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼ NO                      â–¼ YES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡å®šå‘åˆ°       â”‚         â”‚ å…è®¸è®¿é—®      â”‚
â”‚ /sign-in      â”‚         â”‚ å—ä¿æŠ¤è·¯ç”±    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Clerk ç™»å½•é¡µé¢â”‚
â”‚ - é‚®ç®±/å¯†ç    â”‚
â”‚ - Google OAuthâ”‚
â”‚ - GitHub OAuthâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Clerk éªŒè¯    â”‚
â”‚ åˆ›å»º Session  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ checkUser()   â”‚
â”‚ æ•°æ®åº“æ£€æŸ¥    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
    â–¼        â–¼
 å­˜åœ¨      ä¸å­˜åœ¨
    â”‚        â”‚
    â”‚        â–¼
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   â”‚ åˆ›å»ºæ–°ç”¨æˆ·  â”‚
    â”‚   â”‚ User.createâ”‚
    â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ é‡å®šå‘åˆ°   â”‚
            â”‚ /dashboardâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ä½ç½®**:
- ä¸­é—´ä»¶: `middleware.js:32-44`
- ç”¨æˆ·æ£€æŸ¥: `lib/checkUser.js:4-37`

### 4.2 åˆ›å»ºäº¤æ˜“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ·è®¿é—® /transaction/create                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ åŠ è½½è¡¨å•é¡µé¢     â”‚
            â”‚ - è·å–è´¦æˆ·åˆ—è¡¨   â”‚
            â”‚ - åˆå§‹åŒ–è¡¨å•    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                     â”‚
          â–¼                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ‰‹åŠ¨è¾“å…¥  â”‚         â”‚ æ‰«ææ”¶æ®  â”‚
    â”‚ è¡¨å•æ•°æ®  â”‚         â”‚ AI æå–   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â”‚                    â–¼
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚ scanReceipt()    â”‚
         â”‚          â”‚ - Gemini AI OCR  â”‚
         â”‚          â”‚ - æå–é‡‘é¢/æ—¥æœŸ   â”‚
         â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â”‚               â–¼
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚ è‡ªåŠ¨å¡«å……è¡¨å•      â”‚
         â”‚          â”‚ setValue(...)    â”‚
         â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ ç”¨æˆ·æäº¤è¡¨å•     â”‚
            â”‚ handleSubmit()  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Zod éªŒè¯         â”‚
            â”‚ transactionSchemaâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼ å¤±è´¥                    â–¼ æˆåŠŸ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¾ç¤ºé”™è¯¯æç¤º   â”‚         â”‚ è°ƒç”¨ Server   â”‚
â”‚ toast.error() â”‚         â”‚ Action        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚createTransactionâ”‚
                         â”‚ - è®¤è¯æ£€æŸ¥    â”‚
                         â”‚ - é€Ÿç‡é™åˆ¶    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Prisma äº‹åŠ¡   â”‚
                         â”‚ 1. åˆ›å»ºäº¤æ˜“   â”‚
                         â”‚ 2. æ›´æ–°ä½™é¢   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ revalidatePathâ”‚
                         â”‚ /dashboard    â”‚
                         â”‚ /account/[id] â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ è¿”å›æˆåŠŸ      â”‚
                         â”‚ é‡å®šå‘åˆ°è´¦æˆ·  â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ä½ç½®**:
- è¡¨å•: `app/(main)/transaction/_components/transaction-form.jsx:34-332`
- Server Action: `actions/transaction.js:18-100`
- æ”¶æ®æ‰«æ: `actions/transaction.js:231-291`

### 4.3 é¢„ç®—è­¦æŠ¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Inngest è®¡åˆ’ä»»åŠ¡ï¼ˆæ¯ 6 å°æ—¶ï¼‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ checkBudgetAlertsâ”‚
            â”‚ ä½œä¸šå¯åŠ¨         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ è·å–æ‰€æœ‰é¢„ç®—     â”‚
            â”‚ Budget.findMany â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ éå†æ¯ä¸ªé¢„ç®—     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¡ç®—æœ¬æœˆæ”¯å‡º   â”‚         â”‚ æ£€æŸ¥ä¸Šæ¬¡è­¦æŠ¥   â”‚
â”‚ sum(amount)   â”‚         â”‚ lastAlertSent â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ æ”¯å‡º > é¢„ç®— 90%? â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼ NO                      â–¼ YES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è·³è¿‡æ­¤é¢„ç®—     â”‚         â”‚ 24å°æ—¶å†…å‘è¿‡ï¼Ÿ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                         â”‚
                     â–¼ YES                     â–¼ NO
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ è·³è¿‡ï¼ˆé¿å…     â”‚         â”‚ å‘é€è­¦æŠ¥é‚®ä»¶   â”‚
             â”‚  é‡å¤é€šçŸ¥ï¼‰    â”‚         â”‚ sendEmail()   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ æ›´æ–°          â”‚
                                      â”‚ lastAlertSent â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ä½ç½®**:
- Inngest å‡½æ•°: `lib/inngest/function.js:171-230`
- é‚®ä»¶å‘é€: `actions/send-email.js:3-21`

---

## 5. å‰åç«¯äº¤äº’

### 5.1 Server Actions vs API Routes

æœ¬é¡¹ç›®**ä¸»è¦ä½¿ç”¨ Server Actions**ï¼Œè€Œéä¼ ç»Ÿ API Routesã€‚

| å¯¹æ¯”é¡¹ | Server Actions | API Routes |
|-------|---------------|-----------|
| **å®šä¹‰æ–¹å¼** | `"use server"` æŒ‡ä»¤ | `app/api/*/route.js` |
| **è°ƒç”¨æ–¹å¼** | ç›´æ¥å¯¼å…¥å‡½æ•° | `fetch("/api/...")` |
| **ç±»å‹å®‰å…¨** | âœ… å®Œå…¨ç±»å‹å®‰å…¨ | âŒ éœ€è¦æ‰‹åŠ¨ç±»å‹å®šä¹‰ |
| **ä»£ç å…±äº«** | âœ… å‰åç«¯å…±äº«ç±»å‹ | âŒ åˆ†ç¦»çš„ä»£ç åº“ |
| **é€‚ç”¨åœºæ™¯** | è¡¨å•æäº¤ã€æ•°æ®å˜æ›´ | Webhookã€ç¬¬ä¸‰æ–¹é›†æˆ |

**é¡¹ç›®ä¸­çš„ Server Actions**:

| æ–‡ä»¶ | åŒ…å«çš„ Actions | è¯´æ˜ |
|-----|---------------|------|
| `actions/dashboard.js` | getUserAccounts, createAccount, getDashboardData | ä»ªè¡¨æ¿æ•°æ® |
| `actions/transaction.js` | createTransaction, updateTransaction, scanReceipt | äº¤æ˜“ç®¡ç† |
| `actions/account.js` | getAccountWithTransactions, bulkDeleteTransactions | è´¦æˆ·æ“ä½œ |
| `actions/budget.js` | getCurrentBudget, updateBudget | é¢„ç®—ç®¡ç† |

**é¡¹ç›®ä¸­çš„ API Routes**:

| è·¯ç”± | ç”¨é€” |
|-----|------|
| `/api/inngest` | Inngest webhook ç«¯ç‚¹ |
| `/api/seed` | å¼€å‘ç¯å¢ƒæ•°æ®ç§å­ |

### 5.2 æ•°æ®è·å–æ¨¡å¼

#### æœåŠ¡å™¨ç»„ä»¶æ•°æ®è·å–ï¼ˆæ¨èï¼‰

```javascript
// app/(main)/dashboard/page.jsx
export default async function DashboardPage() {
  // å¹¶è¡Œè·å–æ•°æ®
  const [accounts, transactions] = await Promise.all([
    getUserAccounts(),
    getDashboardData(),
  ]);

  // ç›´æ¥æ¸²æŸ“ï¼Œæ— éœ€ loading çŠ¶æ€
  return (
    <div>
      <AccountList accounts={accounts} />
      <TransactionList transactions={transactions} />
    </div>
  );
}
```

**ä¼˜åŠ¿**:
- âœ… æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ŒSEO å‹å¥½
- âœ… æ— éœ€å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†
- âœ… è‡ªåŠ¨ä»£ç åˆ†å‰²

#### å®¢æˆ·ç«¯æ•°æ®å˜æ›´ï¼ˆä½¿ç”¨ useFetchï¼‰

```javascript
// components/create-account-drawer.jsx
const { fn: createAccountFn, loading, error } = useFetch(createAccount);

const onSubmit = async (data) => {
  await createAccountFn(data);
};
```

**useFetch Hook** (`hooks/use-fetch.js`):
- å°è£… loadingã€errorã€data çŠ¶æ€
- è‡ªåŠ¨é”™è¯¯æç¤ºï¼ˆtoastï¼‰
- æ”¯æŒä»»æ„ async å‡½æ•°

### 5.3 è¡¨å•éªŒè¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·è¾“å…¥è¡¨å•å­—æ®µ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ onChange äº‹ä»¶    â”‚
            â”‚ React Hook Form â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Zod Resolver    â”‚
            â”‚ å®æ—¶éªŒè¯         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éªŒè¯å¤±è´¥       â”‚         â”‚ éªŒè¯é€šè¿‡      â”‚
â”‚ errors.field  â”‚         â”‚ æ¸…é™¤é”™è¯¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¾ç¤ºé”™è¯¯æç¤º   â”‚
â”‚ <ErrorMessage>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                     ç”¨æˆ·æäº¤
                        â”‚
                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ handleSubmit()  â”‚
            â”‚ æœ€ç»ˆéªŒè¯         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ‰é”™è¯¯         â”‚         â”‚ æ— é”™è¯¯        â”‚
â”‚ é˜»æ­¢æäº¤       â”‚         â”‚ è°ƒç”¨ Server   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ Action        â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                          ï¼ˆå»ºè®®æ·»åŠ åç«¯éªŒè¯ï¼‰
                                  â”‚
                                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ æ•°æ®åº“æ“ä½œ     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Zod Schema ç¤ºä¾‹** (`app/lib/schema.js`):

```javascript
export const transactionSchema = z
  .object({
    type: z.enum(["INCOME", "EXPENSE"]),
    amount: z.string().min(1, "é‡‘é¢ä¸èƒ½ä¸ºç©º"),
    date: z.date({ required_error: "è¯·é€‰æ‹©æ—¥æœŸ" }),
    accountId: z.string().min(1, "è¯·é€‰æ‹©è´¦æˆ·"),
    category: z.string().min(1, "è¯·é€‰æ‹©åˆ†ç±»"),
    isRecurring: z.boolean().default(false),
    recurringInterval: z.enum(["DAILY", "WEEKLY", "MONTHLY", "YEARLY"]).optional(),
  })
  .superRefine((data, ctx) => {
    // è‡ªå®šä¹‰éªŒè¯ï¼šå¾ªç¯äº¤æ˜“å¿…é¡»æœ‰é—´éš”
    if (data.isRecurring && !data.recurringInterval) {
      ctx.addIssue({
        code: z.ZodIssueCode.custom,
        message: "å¾ªç¯äº¤æ˜“éœ€è¦é€‰æ‹©é—´éš”",
        path: ["recurringInterval"],
      });
    }
  });
```

---

## 6. API æ¥å£æ–‡æ¡£

è™½ç„¶æœ¬é¡¹ç›®ä¸»è¦ä½¿ç”¨ Server Actionsï¼Œä½†è¿™é‡Œåˆ—å‡ºæ‰€æœ‰å¯è°ƒç”¨çš„å‡½æ•°æ¥å£ã€‚

### 6.1 è´¦æˆ·ç®¡ç† API

#### getUserAccounts

**åŠŸèƒ½**: è·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰è´¦æˆ·

**æ–‡ä»¶**: `actions/dashboard.js:21-49`

**è¯·æ±‚å‚æ•°**: æ— ï¼ˆä»è®¤è¯ session è·å– userIdï¼‰

**è¿”å›å€¼**:
```typescript
Array<{
  id: string;
  name: string;
  type: "CURRENT" | "SAVINGS";
  balance: number;
  isDefault: boolean;
  _count: {
    transactions: number;
  };
}>
```

**ç¤ºä¾‹**:
```javascript
const accounts = await getUserAccounts();
// [
//   {
//     id: "abc123",
//     name: "ä¸»è¦è´¦æˆ·",
//     type: "CURRENT",
//     balance: 5000.50,
//     isDefault: true,
//     _count: { transactions: 42 }
//   }
// ]
```

**é”™è¯¯å¤„ç†**:
- `Unauthorized` - æœªç™»å½•
- `User not found` - ç”¨æˆ·ä¸å­˜åœ¨

---

#### createAccount

**åŠŸèƒ½**: åˆ›å»ºæ–°è´¦æˆ·

**æ–‡ä»¶**: `actions/dashboard.js:54-135`

**è¯·æ±‚å‚æ•°**:
```typescript
{
  name: string;           // è´¦æˆ·åç§°
  type: "CURRENT" | "SAVINGS";
  balance: string;        // åˆå§‹ä½™é¢ï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰
  isDefault?: boolean;    // æ˜¯å¦è®¾ä¸ºé»˜è®¤ï¼ˆå¯é€‰ï¼‰
}
```

**è¿”å›å€¼**:
```typescript
{
  success: true;
  data: {
    id: string;
    name: string;
    type: string;
    balance: number;
    isDefault: boolean;
  };
}
```

**ç¤ºä¾‹**:
```javascript
const result = await createAccount({
  name: "å‚¨è“„è´¦æˆ·",
  type: "SAVINGS",
  balance: "10000",
  isDefault: false,
});
```

**é€Ÿç‡é™åˆ¶**: 10 æ¬¡/å°æ—¶

**é”™è¯¯å¤„ç†**:
- `Unauthorized` - æœªç™»å½•
- `Too many requests` - è¶…è¿‡é€Ÿç‡é™åˆ¶
- `Invalid balance amount` - ä½™é¢æ ¼å¼é”™è¯¯

---

### 6.2 äº¤æ˜“ç®¡ç† API

#### createTransaction

**åŠŸèƒ½**: åˆ›å»ºæ–°äº¤æ˜“

**æ–‡ä»¶**: `actions/transaction.js:18-100`

**è¯·æ±‚å‚æ•°**:
```typescript
{
  type: "INCOME" | "EXPENSE";
  amount: string;
  description?: string;
  date: Date;
  accountId: string;
  category: string;
  isRecurring?: boolean;
  recurringInterval?: "DAILY" | "WEEKLY" | "MONTHLY" | "YEARLY";
}
```

**è¿”å›å€¼**:
```typescript
{
  id: string;
  type: string;
  amount: number;
  description: string | null;
  date: string;
  category: string;
  accountId: string;
  // ...
}
```

**ä¸šåŠ¡é€»è¾‘**:
1. éªŒè¯ç”¨æˆ·è®¤è¯
2. æ£€æŸ¥é€Ÿç‡é™åˆ¶
3. éªŒè¯è´¦æˆ·æ‰€æœ‰æƒ
4. **åŸå­æ€§æ“ä½œ**ï¼ˆPrisma äº‹åŠ¡ï¼‰:
   - åˆ›å»ºäº¤æ˜“è®°å½•
   - æ›´æ–°è´¦æˆ·ä½™é¢
5. æ¸…é™¤ç¼“å­˜
6. è¿”å›ç»“æœ

**ç¤ºä¾‹**:
```javascript
const transaction = await createTransaction({
  type: "EXPENSE",
  amount: "50.00",
  description: "åˆé¤",
  date: new Date(),
  accountId: "account_123",
  category: "food",
});
```

**é”™è¯¯å¤„ç†**:
- `Unauthorized` - æœªç™»å½•
- `Too many requests` - è¶…é€Ÿ
- `Account not found` - è´¦æˆ·ä¸å­˜åœ¨
- `Invalid amount` - é‡‘é¢æ— æ•ˆ

---

#### scanReceipt

**åŠŸèƒ½**: AI æ‰«ææ”¶æ®æå–æ•°æ®

**æ–‡ä»¶**: `actions/transaction.js:231-291`

**è¯·æ±‚å‚æ•°**:
```typescript
File  // å›¾ç‰‡æ–‡ä»¶å¯¹è±¡
```

**è¿”å›å€¼**:
```typescript
{
  amount: number;
  date: Date;
  description: string;
  category: string;
}
```

**AI æç¤ºè¯** (å‘é€ç»™ Gemini):
```
åˆ†æè¿™å¼ æ”¶æ®å¹¶æå–ä»¥ä¸‹ä¿¡æ¯ï¼š
- æ€»é‡‘é¢ï¼ˆæ•°å­—ï¼‰
- æ—¥æœŸï¼ˆYYYY-MM-DD æ ¼å¼ï¼‰
- æè¿°ï¼ˆå•†å®¶åç§°æˆ–ç®€çŸ­æè¿°ï¼‰
- åˆ†ç±»ï¼ˆä»é¢„è®¾åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªï¼‰

ä»…è¿”å›æœ‰æ•ˆçš„ JSON å¯¹è±¡ï¼ŒåŒ…å«é”®ï¼šamount, date, description, category
```

**ç¤ºä¾‹**:
```javascript
const scannedData = await scanReceipt(fileObject);
// {
//   amount: 42.50,
//   date: new Date("2024-11-16"),
//   description: "æ˜Ÿå·´å…‹å’–å•¡",
//   category: "food"
// }
```

**é™åˆ¶**:
- æ–‡ä»¶å¤§å°: æœ€å¤§ 5MB
- æ”¯æŒæ ¼å¼: JPG, PNG, WebP
- å¤„ç†æ—¶é—´: 2-5 ç§’

---

### 6.3 é¢„ç®—ç®¡ç† API

#### getCurrentBudget

**åŠŸèƒ½**: è·å–è´¦æˆ·å½“æœˆé¢„ç®—

**æ–‡ä»¶**: `actions/budget.js:9-63`

**è¯·æ±‚å‚æ•°**:
```typescript
accountId: string
```

**è¿”å›å€¼**:
```typescript
{
  id: string;
  amount: number;
  month: number;
  year: number;
  currentSpent: number;      // æœ¬æœˆå·²èŠ±è´¹
  remainingAmount: number;   // å‰©ä½™é¢„ç®—
  percentageUsed: number;    // ä½¿ç”¨ç™¾åˆ†æ¯”
}
```

**ç¤ºä¾‹**:
```javascript
const budget = await getCurrentBudget("account_123");
// {
//   id: "budget_456",
//   amount: 3000,
//   month: 11,
//   year: 2024,
//   currentSpent: 2100,
//   remainingAmount: 900,
//   percentageUsed: 70
// }
```

---

#### updateBudget

**åŠŸèƒ½**: æ›´æ–°æˆ–åˆ›å»ºé¢„ç®—

**æ–‡ä»¶**: `actions/budget.js:68-112`

**è¯·æ±‚å‚æ•°**:
```typescript
{
  accountId: string;
  amount: number;
}
```

**è¿”å›å€¼**: æ›´æ–°åçš„é¢„ç®—å¯¹è±¡

**ä¸šåŠ¡é€»è¾‘**:
- å¦‚æœå½“æœˆé¢„ç®—å­˜åœ¨ â†’ æ›´æ–°
- å¦‚æœä¸å­˜åœ¨ â†’ åˆ›å»ºæ–°é¢„ç®—

**ç¤ºä¾‹**:
```javascript
const budget = await updateBudget({
  accountId: "account_123",
  amount: 3500,
});
```

---

### 6.4 ä»ªè¡¨æ¿æ•°æ® API

#### getDashboardData

**åŠŸèƒ½**: è·å–ä»ªè¡¨æ¿æ¦‚è§ˆæ•°æ®

**æ–‡ä»¶**: `actions/dashboard.js:138-173`

**è¿”å›å€¼**:
```typescript
{
  accounts: Array<Account>;
  recentTransactions: Array<Transaction>;  // æœ€è¿‘ 10 ç¬”
  totalIncome: number;     // æ€»æ”¶å…¥
  totalExpense: number;    // æ€»æ”¯å‡º
  netIncome: number;       // å‡€æ”¶å…¥
}
```

**æ•°æ®èšåˆ**:
- è·å–æ‰€æœ‰è´¦æˆ·
- è·å–æœ€è¿‘ 10 ç¬”äº¤æ˜“ï¼ˆæŒ‰æ—¥æœŸå€’åºï¼‰
- è®¡ç®—æ”¶å…¥/æ”¯å‡ºæ€»é¢

---

## 7. ç¯å¢ƒé…ç½®æŒ‡å—

### 7.1 ç¯å¢ƒå˜é‡æ¸…å•

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆæ ¹ç›®å½•ï¼‰:

```bash
# ==========================================
# æ•°æ®åº“é…ç½®
# ==========================================
# æ± åŒ–è¿æ¥ï¼ˆç”¨äºåº”ç”¨æŸ¥è¯¢ï¼‰
DATABASE_URL="postgresql://user:password@host:5432/database?pgbouncer=true"
# ç›´æ¥è¿æ¥ï¼ˆç”¨äº Prisma è¿ç§»ï¼‰
DIRECT_URL="postgresql://user:password@host:5432/database"

# ==========================================
# è®¤è¯é…ç½® (Clerk)
# ==========================================
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxx
CLERK_SECRET_KEY=sk_test_xxxxx
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/onboarding
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/onboarding

# ==========================================
# AI æœåŠ¡ (Google Gemini)
# ==========================================
GEMINI_API_KEY=xxxxx

# ==========================================
# é‚®ä»¶æœåŠ¡ (Resend)
# ==========================================
RESEND_API_KEY=re_xxxxx

# ==========================================
# å®‰å…¨æœåŠ¡ (ArcJet)
# ==========================================
ARCJET_KEY=ajkey_xxxxx

# ==========================================
# åå°ä½œä¸š (Inngest) - ç”Ÿäº§ç¯å¢ƒå¯é€‰
# ==========================================
INNGEST_EVENT_KEY=xxxxx
INNGEST_SIGNING_KEY=xxxxx
```

### 7.2 è·å– API å¯†é’¥æ­¥éª¤

#### 1. Supabase æ•°æ®åº“

1. è®¿é—® https://supabase.com
2. åˆ›å»ºæ–°é¡¹ç›®
3. **Settings** â†’ **Database**
4. å¤åˆ¶è¿æ¥å­—ç¬¦ä¸²:
   - **Connection String** â†’ `DATABASE_URL`
   - **Direct Connection** â†’ `DIRECT_URL`
5. å¯ç”¨ **Connection Pooling** (PgBouncer)

**è¿æ¥å­—ç¬¦ä¸²æ ¼å¼**:
```
# æ± åŒ–è¿æ¥
postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres?pgbouncer=true

# ç›´æ¥è¿æ¥
postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
```

---

#### 2. Clerk è®¤è¯

1. è®¿é—® https://clerk.com
2. åˆ›å»ºåº”ç”¨ï¼ˆé€‰æ‹© Next.jsï¼‰
3. **Dashboard** â†’ **API Keys**
4. å¤åˆ¶:
   - **Publishable Key** â†’ `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
   - **Secret Key** â†’ `CLERK_SECRET_KEY`
5. é…ç½®é‡å®šå‘ URL:
   - Sign-in URL: `/sign-in`
   - Sign-up URL: `/sign-up`
   - After sign-in: `/onboarding`

---

#### 3. Google Gemini AI

1. è®¿é—® https://makersuite.google.com/app/apikey
2. ç‚¹å‡» **Create API Key**
3. é€‰æ‹© Google Cloud é¡¹ç›®
4. å¤åˆ¶å¯†é’¥ â†’ `GEMINI_API_KEY`
5. åœ¨ **Google Cloud Console** å¯ç”¨ **Gemini API**

**å®šä»·**: å…è´¹å±‚å¯ç”¨ï¼ˆæ¯æœˆ 60 æ¬¡è¯·æ±‚ï¼‰

---

#### 4. Resend é‚®ä»¶

1. è®¿é—® https://resend.com
2. æ³¨å†Œè´¦æˆ·
3. **API Keys** â†’ **Create API Key**
4. å¤åˆ¶å¯†é’¥ â†’ `RESEND_API_KEY`
5. (å¯é€‰) éªŒè¯è‡ªå®šä¹‰åŸŸå

**å…è´¹å±‚**: 100 å°é‚®ä»¶/å¤©

---

#### 5. ArcJet å®‰å…¨

1. è®¿é—® https://arcjet.com
2. åˆ›å»ºç«™ç‚¹
3. å¤åˆ¶ **API Key** â†’ `ARCJET_KEY`
4. é…ç½®è§„åˆ™:
   - Bot Detection: Enabled
   - Shield: Enabled
   - Rate Limiting: 10 req/hour

---

#### 6. Inngest åå°ä½œä¸š

1. è®¿é—® https://inngest.com
2. åˆ›å»ºè´¦æˆ·
3. **å¼€å‘ç¯å¢ƒ**: æ— éœ€é…ç½®
4. **ç”Ÿäº§ç¯å¢ƒ**:
   - æ·»åŠ  webhook: `https://yourdomain.com/api/inngest`
   - å¤åˆ¶ Event Key å’Œ Signing Key

---

### 7.3 æœ¬åœ°å¼€å‘è®¾ç½®

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd ai-finance-platform

# 2. å®‰è£…ä¾èµ–
npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ä½ çš„å¯†é’¥

# 4. ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npx prisma generate

# 5. è¿è¡Œæ•°æ®åº“è¿ç§»
npx prisma migrate deploy

# 6. (å¯é€‰) ç§å­ç¤ºä¾‹æ•°æ®
curl http://localhost:3000/api/seed

# 7. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

è®¿é—®: http://localhost:3000

---

## 8. äºŒæ¬¡å¼€å‘æŒ‡å—

### 8.1 é¡¹ç›®ç»“æ„è¯´æ˜

```
ai-finance-platform/
â”œâ”€â”€ app/                        # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/                 # è®¤è¯è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ sign-in/           # ç™»å½•é¡µ
â”‚   â”‚   â””â”€â”€ sign-up/           # æ³¨å†Œé¡µ
â”‚   â”œâ”€â”€ (main)/                 # ä¸»åº”ç”¨è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ dashboard/         # ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ transaction/       # äº¤æ˜“ç®¡ç†
â”‚   â”‚   â””â”€â”€ account/           # è´¦æˆ·è¯¦æƒ…
â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ inngest/           # Inngest webhook
â”‚   â”‚   â””â”€â”€ seed/              # æ•°æ®ç§å­
â”‚   â”œâ”€â”€ lib/                    # å…±äº«åº“
â”‚   â”‚   â””â”€â”€ schema.js          # Zod éªŒè¯ schema
â”‚   â”œâ”€â”€ layout.js              # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.js                # é¦–é¡µ
â”‚   â””â”€â”€ globals.css            # å…¨å±€æ ·å¼
â”œâ”€â”€ actions/                    # Server Actions
â”‚   â”œâ”€â”€ dashboard.js           # ä»ªè¡¨æ¿æ“ä½œ
â”‚   â”œâ”€â”€ transaction.js         # äº¤æ˜“æ“ä½œ
â”‚   â”œâ”€â”€ account.js             # è´¦æˆ·æ“ä½œ
â”‚   â””â”€â”€ budget.js              # é¢„ç®—æ“ä½œ
â”œâ”€â”€ components/                 # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                    # Radix UI åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ header.jsx             # å…¨å±€å¤´éƒ¨
â”‚   â””â”€â”€ create-account-drawer.jsx
â”œâ”€â”€ hooks/                      # è‡ªå®šä¹‰ Hooks
â”‚   â””â”€â”€ use-fetch.js           # å¼‚æ­¥æ“ä½œå°è£…
â”œâ”€â”€ lib/                        # å·¥å…·åº“
â”‚   â”œâ”€â”€ prisma.js              # Prisma å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ arcjet.js              # ArcJet é…ç½®
â”‚   â”œâ”€â”€ checkUser.js           # ç”¨æˆ·åŒæ­¥
â”‚   â””â”€â”€ inngest/               # Inngest é…ç½®
â”‚       â”œâ”€â”€ client.js          # Inngest å®¢æˆ·ç«¯
â”‚       â””â”€â”€ function.js        # åå°ä½œä¸šå‡½æ•°
â”œâ”€â”€ prisma/                     # Prisma é…ç½®
â”‚   â”œâ”€â”€ schema.prisma          # æ•°æ®åº“ schema
â”‚   â””â”€â”€ migrations/            # è¿ç§»æ–‡ä»¶
â”œâ”€â”€ data/                       # é™æ€æ•°æ®
â”‚   â”œâ”€â”€ categories.js          # äº¤æ˜“åˆ†ç±»
â”‚   â””â”€â”€ landing.js             # é¦–é¡µå†…å®¹
â”œâ”€â”€ middleware.js               # Next.js ä¸­é—´ä»¶
â”œâ”€â”€ next.config.mjs            # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.js         # Tailwind é…ç½®
â””â”€â”€ package.json               # é¡¹ç›®ä¾èµ–
```

### 8.2 å¸¸è§å¼€å‘ä»»åŠ¡

#### ä»»åŠ¡ 1: æ·»åŠ æ–°çš„äº¤æ˜“åˆ†ç±»

**æ­¥éª¤**:

1. ç¼–è¾‘ `data/categories.js`
2. æ·»åŠ æ–°åˆ†ç±»åˆ° `incomeCategories` æˆ– `expenseCategories`

```javascript
// data/categories.js
export const expenseCategories = [
  // ... ç°æœ‰åˆ†ç±»
  {
    value: "pets",
    label: "å® ç‰©",
    icon: "ğŸ•",
  },
];
```

3. æ— éœ€é‡å¯æœåŠ¡å™¨ï¼Œç›´æ¥åˆ·æ–°é¡µé¢

---

#### ä»»åŠ¡ 2: åˆ›å»ºæ–°çš„ Server Action

**æ­¥éª¤**:

1. åœ¨ `actions/` ç›®å½•åˆ›å»ºæˆ–ç¼–è¾‘æ–‡ä»¶
2. æ·»åŠ  `"use server"` æŒ‡ä»¤
3. å®ç°å‡½æ•°é€»è¾‘

```javascript
// actions/custom.js
"use server";

import { auth } from "@clerk/nextjs/server";
import { db } from "@/lib/prisma";

export async function myNewAction(data) {
  // 1. è®¤è¯æ£€æŸ¥
  const { userId } = await auth();
  if (!userId) throw new Error("Unauthorized");

  // 2. è·å–ç”¨æˆ·
  const user = await db.user.findUnique({
    where: { clerkUserId: userId },
  });

  // 3. ä¸šåŠ¡é€»è¾‘
  const result = await db.someModel.create({
    data: {
      ...data,
      userId: user.id,
    },
  });

  // 4. æ¸…é™¤ç¼“å­˜
  revalidatePath("/dashboard");

  // 5. è¿”å›ç»“æœ
  return result;
}
```

4. åœ¨ç»„ä»¶ä¸­è°ƒç”¨:

```javascript
import { myNewAction } from "@/actions/custom";

const { fn } = useFetch(myNewAction);
await fn({ /* data */ });
```

---

#### ä»»åŠ¡ 3: æ·»åŠ æ–°é¡µé¢

**æ­¥éª¤**:

1. åœ¨ `app/(main)/` åˆ›å»ºæ–°æ–‡ä»¶å¤¹
2. æ·»åŠ  `page.jsx`

```javascript
// app/(main)/reports/page.jsx
import { getUserReports } from "@/actions/reports";

export default async function ReportsPage() {
  const reports = await getUserReports();

  return (
    <div>
      <h1>è´¢åŠ¡æŠ¥å‘Š</h1>
      {reports.map(report => (
        <div key={report.id}>{report.name}</div>
      ))}
    </div>
  );
}
```

3. æ·»åŠ å¯¼èˆªé“¾æ¥ (`components/header.jsx`):

```javascript
<Link href="/reports">æŠ¥å‘Š</Link>
```

4. æ›´æ–°ä¸­é—´ä»¶ä¿æŠ¤è·¯ç”± (`middleware.js`):

```javascript
const isProtectedRoute = createRouteMatcher([
  "/dashboard(.*)",
  "/account(.*)",
  "/transaction(.*)",
  "/reports(.*)",  // æ·»åŠ è¿™è¡Œ
]);
```

---

#### ä»»åŠ¡ 4: ä¿®æ”¹æ•°æ®åº“ Schema

**æ­¥éª¤**:

1. ç¼–è¾‘ `prisma/schema.prisma`

```prisma
model Transaction {
  // ... ç°æœ‰å­—æ®µ
  tags String[]  // æ–°å¢å­—æ®µï¼šæ ‡ç­¾æ•°ç»„
}
```

2. åˆ›å»ºè¿ç§»:

```bash
npx prisma migrate dev --name add_tags_to_transaction
```

3. é‡æ–°ç”Ÿæˆ Prisma å®¢æˆ·ç«¯:

```bash
npx prisma generate
```

4. æ›´æ–°ç›¸å…³ä»£ç ä½¿ç”¨æ–°å­—æ®µ

---

#### ä»»åŠ¡ 5: æ·»åŠ æ–°çš„ Inngest åå°ä½œä¸š

**æ­¥éª¤**:

1. ç¼–è¾‘ `lib/inngest/function.js`
2. æ·»åŠ æ–°å‡½æ•°

```javascript
export const myNewJob = inngest.createFunction(
  { id: "my-new-job" },
  { cron: "0 0 * * *" },  // æ¯å¤©åˆå¤œ
  async ({ step }) => {
    await step.run("execute-task", async () => {
      // ä½ çš„é€»è¾‘
      const users = await db.user.findMany();

      for (const user of users) {
        // å¤„ç†æ¯ä¸ªç”¨æˆ·
      }
    });
  }
);
```

3. æ³¨å†Œå‡½æ•° (`app/api/inngest/route.js`):

```javascript
import { myNewJob } from "@/lib/inngest/function";

export const { GET, POST, PUT } = serve({
  client: inngest,
  functions: [
    processRecurringTransaction,
    triggerRecurringTransactions,
    generateMonthlyReports,
    checkBudgetAlerts,
    myNewJob,  // æ·»åŠ è¿™è¡Œ
  ],
});
```

---

### 8.3 è°ƒè¯•æŠ€å·§

#### 1. ä½¿ç”¨ Console æ—¥å¿—

```javascript
// Server Action
export async function myAction(data) {
  console.log("æ¥æ”¶åˆ°çš„æ•°æ®:", data);

  const result = await db.transaction.create({ data });
  console.log("åˆ›å»ºçš„äº¤æ˜“:", result);

  return result;
}
```

**æŸ¥çœ‹æ—¥å¿—**:
- å¼€å‘ç¯å¢ƒ: ç»ˆç«¯è¾“å‡º
- ç”Ÿäº§ç¯å¢ƒ: Vercel Dashboard â†’ Logs

---

#### 2. ä½¿ç”¨ Prisma Studio

```bash
npx prisma studio
```

è®¿é—® http://localhost:5555 æŸ¥çœ‹å’Œç¼–è¾‘æ•°æ®åº“æ•°æ®

---

#### 3. é”™è¯¯è¾¹ç•Œ

æ·»åŠ  `error.js` æ–‡ä»¶æ•è·é”™è¯¯:

```javascript
// app/(main)/dashboard/error.js
"use client";

export default function Error({ error, reset }) {
  return (
    <div>
      <h2>å‡ºé”™äº†ï¼</h2>
      <p>{error.message}</p>
      <button onClick={() => reset()}>é‡è¯•</button>
    </div>
  );
}
```

---

#### 4. React DevTools

å®‰è£… React DevTools æµè§ˆå™¨æ‰©å±•ï¼Œæ£€æŸ¥ç»„ä»¶æ ‘å’Œ props

---

### 8.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. ä½¿ç”¨ Suspense è¾¹ç•Œ

```javascript
<Suspense fallback={<Loading />}>
  <SlowComponent />
</Suspense>
```

#### 2. ä¼˜åŒ–å›¾ç‰‡

ä½¿ç”¨ Next.js `<Image>` ç»„ä»¶:

```javascript
import Image from "next/image";

<Image
  src="/logo.png"
  width={200}
  height={100}
  alt="Logo"
  priority  // é¦–å±å›¾ç‰‡
/>
```

#### 3. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

```javascript
// âŒ ä¸å¥½ï¼šN+1 æŸ¥è¯¢
const accounts = await db.account.findMany();
for (const account of accounts) {
  const transactions = await db.transaction.findMany({
    where: { accountId: account.id }
  });
}

// âœ… å¥½ï¼šä½¿ç”¨ include
const accounts = await db.account.findMany({
  include: {
    transactions: true,
  },
});
```

#### 4. ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—

```javascript
const filteredTransactions = useMemo(() => {
  return transactions.filter(t => t.type === "EXPENSE");
}, [transactions]);
```

---

## 9. éƒ¨ç½²æŒ‡å—

### 9.1 Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

**æ­¥éª¤**:

1. **å®‰è£… Vercel CLI**:
```bash
npm i -g vercel
```

2. **ç™»å½•**:
```bash
vercel login
```

3. **éƒ¨ç½²**:
```bash
vercel --prod
```

4. **é…ç½®ç¯å¢ƒå˜é‡**:
   - è®¿é—® Vercel Dashboard
   - é¡¹ç›® â†’ Settings â†’ Environment Variables
   - æ·»åŠ æ‰€æœ‰ `.env` ä¸­çš„å˜é‡

5. **é…ç½® Inngest Webhook**:
   - éƒ¨ç½²åè·å–åŸŸå: `https://your-app.vercel.app`
   - åœ¨ Inngest Dashboard æ·»åŠ : `https://your-app.vercel.app/api/inngest`

---

### 9.2 Docker éƒ¨ç½²

**åˆ›å»º Dockerfile**:

```dockerfile
FROM node:22-alpine AS deps
WORKDIR /app
COPY package*.json ./
RUN npm ci

FROM node:22-alpine AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npx prisma generate
RUN npm run build

FROM node:22-alpine AS runner
WORKDIR /app
ENV NODE_ENV=production
COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

EXPOSE 3000
CMD ["node", "server.js"]
```

**æ„å»ºå’Œè¿è¡Œ**:
```bash
docker build -t ai-finance-platform .
docker run -p 3000:3000 --env-file .env ai-finance-platform
```

---

### 9.3 éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰ç¡®è®¤:

- [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ•°æ®åº“è¿ç§»å·²è¿è¡Œ
- [ ] API å¯†é’¥æœ‰æ•ˆ
- [ ] Clerk é‡å®šå‘ URL å·²æ›´æ–°
- [ ] Inngest webhook å·²æ³¨å†Œ
- [ ] æ„å»ºæˆåŠŸ (`npm run build`)
- [ ] æœ¬åœ°ç”Ÿäº§æµ‹è¯•é€šè¿‡ (`npm start`)
- [ ] ArcJet è§„åˆ™å·²é…ç½®
- [ ] é‚®ä»¶æœåŠ¡å·²éªŒè¯

éƒ¨ç½²åéªŒè¯:

- [ ] é¦–é¡µåŠ è½½æ­£å¸¸
- [ ] ç”¨æˆ·æ³¨å†Œ/ç™»å½•æµç¨‹
- [ ] åˆ›å»ºè´¦æˆ·
- [ ] æ·»åŠ äº¤æ˜“
- [ ] æ”¶æ®æ‰«æåŠŸèƒ½
- [ ] é¢„ç®—è®¾ç½®
- [ ] é‚®ä»¶é€šçŸ¥å‘é€

---

## 10. é™„å½•

### 10.1 æŠ€æœ¯æœ¯è¯­è¡¨

| æœ¯è¯­ | è§£é‡Š |
|-----|------|
| **Server Component** | åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„ React ç»„ä»¶ï¼Œä¸å‘é€ JS åˆ°å®¢æˆ·ç«¯ |
| **Server Action** | Next.js 15 çš„æœåŠ¡å™¨ç«¯å‡½æ•°ï¼Œå¯ç›´æ¥ä»å®¢æˆ·ç«¯è°ƒç”¨ |
| **Prisma ORM** | ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®å±‚ï¼Œè‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢ API |
| **Middleware** | Next.js ä¸­é—´ä»¶ï¼Œåœ¨è¯·æ±‚åˆ°è¾¾é¡µé¢å‰æ‰§è¡Œ |
| **revalidatePath** | æ¸…é™¤ Next.js ç¼“å­˜ï¼Œå¼ºåˆ¶é‡æ–°è·å–æ•°æ® |
| **Zod** | TypeScript-first çš„ schema éªŒè¯åº“ |
| **Clerk** | ç¬¬ä¸‰æ–¹è®¤è¯æœåŠ¡ï¼Œå¤„ç†ç”¨æˆ·ç™»å½•å’Œä¼šè¯ |
| **ArcJet** | å®‰å…¨æœåŠ¡ï¼Œæä¾› bot æ£€æµ‹å’Œé€Ÿç‡é™åˆ¶ |
| **Inngest** | åå°ä½œä¸šå¹³å°ï¼Œå¤„ç†è®¡åˆ’ä»»åŠ¡å’Œå¼‚æ­¥æ“ä½œ |

### 10.2 å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# å¼€å‘
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build            # ç”Ÿäº§æ„å»º
npm start                # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run lint             # ä»£ç æ£€æŸ¥

# Prisma
npx prisma generate      # ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npx prisma migrate dev   # åˆ›å»ºå¹¶åº”ç”¨è¿ç§»ï¼ˆå¼€å‘ï¼‰
npx prisma migrate deploy # åº”ç”¨è¿ç§»ï¼ˆç”Ÿäº§ï¼‰
npx prisma studio        # æ‰“å¼€æ•°æ®åº“ GUI
npx prisma db pull       # ä»æ•°æ®åº“ç”Ÿæˆ schema
npx prisma db push       # æ¨é€ schema åˆ°æ•°æ®åº“ï¼ˆè·³è¿‡è¿ç§»ï¼‰

# æ•°æ®åº“
npx prisma migrate reset # é‡ç½®æ•°æ®åº“ï¼ˆå±é™©ï¼ï¼‰
curl http://localhost:3000/api/seed # ç§å­æ•°æ®

# éƒ¨ç½²
vercel                   # éƒ¨ç½²åˆ° Vercelï¼ˆé¢„è§ˆï¼‰
vercel --prod            # éƒ¨ç½²åˆ° Vercelï¼ˆç”Ÿäº§ï¼‰
```

### 10.3 å­¦ä¹ èµ„æºæ¨è

#### å®˜æ–¹æ–‡æ¡£

- [Next.js 15 æ–‡æ¡£](https://nextjs.org/docs)
- [React 19 æ–‡æ¡£](https://react.dev)
- [Prisma æ–‡æ¡£](https://www.prisma.io/docs)
- [Tailwind CSS](https://tailwindcss.com/docs)
- [Clerk æ–‡æ¡£](https://clerk.com/docs)

#### ä¸­æ–‡æ•™ç¨‹

- [Next.js ä¸­æ–‡æ–‡æ¡£](https://nextjs.org/docs)
- [Prisma ä¸­æ–‡æ•™ç¨‹](https://prisma.yoga)
- [React ä¸­æ–‡æ–‡æ¡£](https://zh-hans.react.dev)

#### è§†é¢‘æ•™ç¨‹

- Bç«™æœç´¢: "Next.js 15 æ•™ç¨‹"
- YouTube: "Next.js App Router Tutorial"

### 10.4 å¸¸è§é—®é¢˜ FAQ

**Q: å¦‚ä½•æ·»åŠ æ–°ç”¨æˆ·ï¼Ÿ**

A: ç”¨æˆ·é€šè¿‡ Clerk æ³¨å†Œåè‡ªåŠ¨åˆ›å»ºã€‚`checkUser()` å‡½æ•°ä¼šåŒæ­¥ Clerk ç”¨æˆ·åˆ°æ•°æ®åº“ã€‚

**Q: å¦‚ä½•ä¿®æ”¹é»˜è®¤åˆ†ç±»åˆ—è¡¨ï¼Ÿ**

A: ç¼–è¾‘ `data/categories.js` æ–‡ä»¶ï¼Œæ·»åŠ æˆ–åˆ é™¤åˆ†ç±»ã€‚

**Q: æ•°æ®åº“è¿ç§»å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

A: æ£€æŸ¥ `DATABASE_URL` å’Œ `DIRECT_URL` é…ç½®ã€‚è¿ç§»å¿…é¡»ä½¿ç”¨ `DIRECT_URL`ï¼ˆä¸é€šè¿‡è¿æ¥æ± ï¼‰ã€‚

**Q: æ”¶æ®æ‰«æä¸å·¥ä½œï¼Ÿ**

A: æ£€æŸ¥ `GEMINI_API_KEY` æ˜¯å¦æœ‰æ•ˆï¼Œç¡®ä¿ Google Cloud é¡¹ç›®å·²å¯ç”¨ Gemini APIã€‚

**Q: å¦‚ä½•æ›´æ”¹é€Ÿç‡é™åˆ¶ï¼Ÿ**

A: ç¼–è¾‘ `lib/arcjet.js`ï¼Œä¿®æ”¹ `refillRate` å’Œ `capacity` å‚æ•°ã€‚

**Q: é‚®ä»¶å‘é€å¤±è´¥ï¼Ÿ**

A: éªŒè¯ `RESEND_API_KEY`ï¼Œæ£€æŸ¥ Resend ä»ªè¡¨æ¿çš„å‘é€æ—¥å¿—ã€‚

**Q: Inngest ä½œä¸šä¸æ‰§è¡Œï¼Ÿ**

A: å¼€å‘ç¯å¢ƒç¡®ä¿ Inngest Dev Server è¿è¡Œã€‚ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥ webhook é…ç½®ã€‚

**Q: å¦‚ä½•å¤‡ä»½æ•°æ®åº“ï¼Ÿ**

A: ä½¿ç”¨ `pg_dump` æˆ– Supabase ä»ªè¡¨æ¿çš„å¤‡ä»½åŠŸèƒ½ã€‚

**Q: å¦‚ä½•æ·»åŠ æš—è‰²æ¨¡å¼ï¼Ÿ**

A: ä½¿ç”¨ `next-themes` åº“ï¼Œé…åˆ Tailwind çš„ `dark:` å‰ç¼€ã€‚

**Q: æ€§èƒ½æ…¢æ€ä¹ˆä¼˜åŒ–ï¼Ÿ**

A: æ£€æŸ¥æ•°æ®åº“æŸ¥è¯¢ï¼ˆPrisma Studioï¼‰ï¼Œä½¿ç”¨ `include` ä»£æ›¿å¤šæ¬¡æŸ¥è¯¢ï¼Œæ·»åŠ ç´¢å¼•ã€‚

---

## ç»“è¯­

æœ¬è§„æ ¼æ–‡æ¡£æä¾›äº† AI Finance Platform çš„å®Œæ•´æŠ€æœ¯æ¦‚è§ˆã€‚å»ºè®®ç»“åˆä»¥ä¸‹èµ„æºä¸€èµ·ä½¿ç”¨ï¼š

1. **é¡¹ç›®åˆ†ææ–‡æ¡£** - `project-mastery/analysis/` ç›®å½•
2. **æ•™å­¦æŒ‡å—** - `project-mastery/teaching-guide/` ç›®å½•
3. **æºä»£ç æ³¨é‡Š** - ç›´æ¥é˜…è¯»ä»£ç ä¸­çš„æ³¨é‡Š

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…ï¼š
- å®˜æ–¹æ–‡æ¡£é“¾æ¥
- GitHub Issues
- é¡¹ç›® README.md

ç¥å¼€å‘é¡ºåˆ©ï¼ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-11-16
**ç»´æŠ¤è€…**: AI Finance Platform Team
